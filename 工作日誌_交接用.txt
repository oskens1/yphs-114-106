# 學生積分銀行整合專案 - 工作日誌 (2026/02/15)

## 專案目標
整合「校務行政系統爬蟲」與「Google Sheets 積分銀行」，實現每週自動化打卡發分（1次打卡=5分）。

## 已完成工作 (截至 12:20 PM)
1. **目錄結構優化**：
   - 將檔案分類為 `scrapers/`, `gas/`, `data/`, `utils/`。
   - 正式命名：`test.py` -> `attendance_scraper.py`。
   
2. **爬蟲效能優化 (智慧銜接模式)**：
   - 修正了原本會重複掃描舊日期的問題。
   - **現有機制**：爬蟲往回找日期時，只要撞到 Excel 中已有的分頁，立即停止抓取，實現秒速同步。

3. **點數計算核心 (`utils/point_calculator.py`)**：
   - 支援解析多種座號格式 (10601, 1號, 1)。
   - 支援「日期區間過濾」，預設自動鎖定「上週一到週五」。

4. **雲端 API 部署 (`gas/`)**：
   - 已透過 `clasp` 部署優化後的 GAS 程式碼。
   - 新增 `apiUpdateAttendancePoints` 介面，支援 Python 批次傳輸加分清單與事由。
   - 自動在 `PointLogs` 分頁寫入紀錄。

5. **使用者介面與環境**：
   - 建立了 `一鍵啟動積分系統.bat` (已修復 UTF-8 亂碼與環境路徑)。
   - 打包了具備圖示的 `106積分銀行一鍵發分.exe` (位於 `dist/`)。
   - 環境建議：使用 **`omr_mini`** 虛擬環境運作。

## 待接續工作 / 測試
- [ ] **歷史資料測試**：建議回家後用桌機執行 `.bat`，選 `n` (不抓資料) -> `y` (手動區間) -> 輸入 `114-12-21`，核對預覽名單後按 `y` 測試雲端同步。
- [ ] **新學期正式啟動**：2/23 開學後，每週五執行一次即可。

## 開發者提示
- **Python 環境**：需安裝 `DrissionPage`, `pandas`, `requests`, `openpyxl`。
- **Web App URL**：已填入 `main.py` 第 10 行，無須更動。
- **GAS 推播**：若需改動雲端 Code，於 `gas/` 目錄執行 `clasp push -f`。

---
* Cline AI 代理人 敬上
