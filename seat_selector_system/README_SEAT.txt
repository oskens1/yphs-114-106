# 永久性選座位系統 (v2.0) - 使用說明

本資料夾整合了「管理員後台」、「學生選位端」與「歷史存檔邏輯」。

## 📁 檔案說明
1.  **code.gs**：後端核心邏輯。負責路由(Routing)、身分驗證、加權抽籤、以及「永久性存檔」。
2.  **index.html**：學生端介面。包含自動同步鎖定狀態、即時座位圖與選位功能。
3.  **admin.html**：老師管理與投影介面。內建 QR Code 產生器、一鍵開關選位、執行抽籤與存檔功能。

## 🚀 部署步驟 (Google Apps Script)
1.  開啟您的 Google Sheets 試算表。
2.  點選工具列的「擴充功能」 > 「Apps Script」。
3.  在 Apps Script 編輯器中：
    *   將 `code.gs` 的內容貼入（或替換原本的內容）。
    *   點選左側「+」號新增 HTML 檔案，命名為 `index`，並貼入 `index.html` 內容。
    *   再新增一個 HTML 檔案，命名為 `admin`，並貼入 `admin.html` 內容。
4.  點選右上方「部署」 > 「新部署」：
    *   類型選擇「網頁應用程式」。
    *   執行身分：選擇「您自己」。
    *   誰可以存取：選擇「所有人」。
5.  部署成功後，您會獲得一個 **Web App 網址**。

## 🛠️ 如何使用
*   **學生端**：直接開啟 Web App 網址即可登入選位。
*   **老師管理端**：在 Web App 網址後面加上 `?page=admin` 即可進入管理後台。
    *   範例：`https://script.google.com/.../exec?page=admin`
*   **投影模式**：在教室投影時，打開管理端網頁，畫面會自動產生 QR Code 給學生掃描，並即時動態顯示選位熱度。
*   **存檔機制**：當這輪選位結束後，按下「存檔並重置」，系統會自動將結果備份到 `History_Log` 工作表，並清空現場供下一輪使用。

## 📌 注意事項
*   請確保您的 Google Sheets 中有 `Students`、`Seat_View`、`History_Log` 與 `Config` 工作表（程式會自動嘗試建立缺少的，但建議手動檢查）。
*   學生登入預設比對 A 欄(座號)與 F 欄(密碼)。

---
整合開發人：Cline AI 代理人
日期：2026/02/15
